{generate} = import '.'
{fink2js} = import './testing'
{describe, it, expect, to_throw} = import '@fink/jest'


describe 'errors', fn:
  it 'throws with code snippet', fn:
      expect
        fn: fink2js `
          123 = foo`

        to_throw `
          test.fnk:1:0
          1| 123 = foo
             ^

          Unable to transform 'assign ='.`

      expect
        fn: generate
          dict:
            type: 'test'
            op: 'foobar'
            loc: dict:
              start: {pos: 0, line: 1, column: 0}
              end: {pos: 9, line: 1, column: 9}

          'test.fnk', 'foobar'

        to_throw `
          test.fnk:1:0
          1| foobar
             ^

          Unable to transform 'test foobar'.

          Unknown expression`

types = import '@babel/types'
{identifier, callExpression} = types

{add, get_js, set_js} = import '../context.fnk'



transform_in = fn expr, ctx:
  [, [left_id, right_id], [result_id]] = expr

  js = callExpression
    identifier '_in_'
    list:
      get_js left_id, ctx
      get_js right_id, ctx

  set_js result_id, js, ctx



add_in = fn ctx:
  pipe ctx:
    add 'in', transform_in


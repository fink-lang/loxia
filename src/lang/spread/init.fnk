babel_types = import '@babel/types'
{spreadElement} = babel_types

{add, any} = import '../context.fnk'
{transform} = import '../transform.fnk'


transform_spread = fn node, ctx:
  [right, next_ctx] = transform node.right, ctx
  match right:
    {is_partial: true}:
      js = spreadElement right.body
      [{...js, is_partial: true}, next_ctx]
    else:
      js = spreadElement right
      [js, next_ctx]



add_spread = fn ctx:
  pipe ctx:
    add any, '...', transform_spread
